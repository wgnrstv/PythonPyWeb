
        <html>
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Оглавление</title>

            <link rel="stylesheet" href="/js_css/main.css">
            <link rel="stylesheet" href="/js_css/default.min.css">
            <!-- Подключаем js -->
            <script src="/js_css/copy.js"></script>
            <script src="/js_css/highlight.min.js"></script>
            <script>hljs.highlightAll();</script>
        </head>
        <body>
            <div class="sidebar">
<ul>
<li><a href="#1">1. Введение</a></li>
<li><a href="#2">2. Знакомство с административной панелью</a><ul>
<li><a href="#21">2.1 Аутентификация и авторизация</a></li>
<li><a href="#22">2.2 Основные таблицы приложения Блог</a></li>
</ul>
</li>
<li><a href="#3-django">3. Создание моделей в Django</a><ul>
<li><a href="#31">3.1 Описание полей</a></li>
<li><a href="#32">3.2 Применение параметров</a></li>
<li><a href="#33">3.3 Создание таблицы в БД</a></li>
<li><a href="#34">3.4 Изменение структуры таблицы в БД</a></li>
<li><a href="#35">3.5 Заполнение данных в БД</a></li>
<li><a href="#36">3.6 Получение, изменение, удаление данных из БД</a><ul>
<li><a href="#361">3.6.1 Получение</a></li>
<li><a href="#362">3.6.2 Обновление</a></li>
<li><a href="#363">3.6.3 Удаление</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_1">Практика закончена</a></li>
</ul>
</div>
<div class="content">
<h1 id="1">1. Введение</h1>
<ol>
<li>Начнем с создания миграции</li>
</ol>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-1">python manage.py makemigrations
</code></pre><button class="copy-button" onclick="copyCode('code-block-1')">Копировать код</button></div>

<ol>
<li>Создадим таблицы в базе данных (БД)</li>
</ol>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-2">python manage.py migrate
</code></pre><button class="copy-button" onclick="copyCode('code-block-2')">Копировать код</button></div>

<ol>
<li>Запустим сервер</li>
</ol>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-3">python manage.py runserver
</code></pre><button class="copy-button" onclick="copyCode('code-block-3')">Копировать код</button></div>

<p>Перейдем по <a href="http://127.0.0.1:8000/" target="_blank">http://127.0.0.1:8000/</a> и увидим, что чего-то не хватает. Так как основное наполнение идет через базу данных 
(БД). Для этого произведем загрузку(перенос) данных в БД из её фикстуры(слепка). В фикстуре содержится вся информация о заполнении БД.
Однако, фикстура это всего лишь заполнение БД, без структуры (какие именно таблицы и какие есть связи в БД), которую 
мы переносили при помощи команды (<code>migrate</code>) фикстуру не применить.</p>
<p>Ознакомьтесь с содержанием файла <code>data_db.json</code> по ключевому слову <code>app.entry</code> в этом файле найдите статьи, ознакомьтесь с
полями у этой таблицы.</p>
<p><img alt="img.png" src="pic/img.png" /></p>
<ol>
<li>Теперь загрузим эти данные (фикстуру)</li>
</ol>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-4">python manage.py loaddata data_db.json
</code></pre><button class="copy-button" onclick="copyCode('code-block-4')">Копировать код</button></div>

<p><img alt="img_1.png" src="pic/img_1.png" /></p>
<p>Так как данные уже есть в БД, то <code>Блог</code> показывает нужную информацию.</p>
<h1 id="2">2. Знакомство с административной панелью</h1>
<p>Django в отличие от большинства других библиотек или фреймворков обладает встроенной административной панелью (но и в других 
библиотеках можно скачать модулю которые закроют данный функционал, если он требуется). Административная панель это страница, с
базовыми функциями для администрирования сайта. С помощью админ понели достаточно просто и удобно работать со значениями таблиц БД. </p>
<p>Чтобы зайти в неё достаточно перейти по адресу <a href="http://127.0.0.1:8000/admin" target="_blank">http://127.0.0.1:8000/admin</a></p>
<p>В курсах ранее мы с вами создавали суперпользователя(он же админ) используя команду <code>manage.py createsuperuser</code>, но 
пока этого не нужно, необходимые пользователи и админ был загружен через фикстуру.</p>
<p>Зайдите в админ панель по адресу <a href="http://127.0.0.1:8000/admin" target="_blank">http://127.0.0.1:8000/admin</a> под: </p>
<p>Username: <code>admin</code>
Password: <code>123</code></p>
<p><img alt="img_2.png" src="pic/img_2.png" /></p>
<p>Затем попадаете в само отображение админ панели, где на данный момент есть 2 блока
<code>Authentication and Authorization</code> и <code>Приложение</code>. </p>
<p><img alt="img_4.png" src="pic/img_4.png" /></p>
<p>Визуальное отображение админ панели можно изменить при помощи сторонних библиотек, кому интересно, то подробнее 
можно почитать здесь <a href="https://docs.google.com/document/d/1S9bGmy-83u-7P2b-Kpt1tVUQqiBAGRS5RUxyJkLQ6yQ/edit?usp=sharing" target="_blank">https://docs.google.com/document/d/1S9bGmy-83u-7P2b-Kpt1tVUQqiBAGRS5RUxyJkLQ6yQ/edit?usp=sharing</a> (информация только для интересующихся, 
выполнять в рамках практики примеры из материала не нужно).</p>
<h2 id="21">2.1 Аутентификация и авторизация</h2>
<p>Первый блок посвящен системе аутентификации (определение кто зашел на страницу, какой пользователь) 
и авторизации (определение какие права есть у данного пользователя, что ему можно показывать, а что нет)</p>
<p><img alt="img_3.png" src="pic/img_3.png" /></p>
<p>Все пользователи содержатся в <code>Users</code>, зайдите на вкладку и посмотрите на текущих пользователей в БД. Всего будет 41 пользователь,
Один админ, 5 пользователей со статусом персонала (staff status будет с зеленой галочкой) и 35 обычных пользователей.</p>
<p>Создайте нового пользователя через admin панель, для этого нажмите на <code>+Add</code> на левой панели в строке <code>Users</code>.</p>
<p><img alt="img_5.png" src="pic/img_5.png" /></p>
<p>Придумайте Username, а также пароль, повторите пароль. В этот раз придётся соблюсти правила защищенного пароля. 
<code>123456 не пропустит форма</code>, но чтобы не выдумывать сложный пароль для теста, можно на английской клавиатуре пробежаться 
змейкой от 1 вниз до 2 вверх с зажатым Shift. Пароль тогда будет такой <code>!QAZXSW@</code> такой пароль Django пропустит. Затем
нажмите на <code>Save</code></p>
<p><img alt="img_6.png" src="pic/img_6.png" /></p>
<p>Далее появится дополнительная информация о пользователе, где можно заполнить персональные данные, а также поработать с 
разрешениями (permissions) и если это необходимо наделить созданного пользователя правами персонала (staff status) или админа 
(superuser status). Также возможно добавить пользователя в определенные группы разрешений (про это рассмотрим далее).</p>
<p>Если сделали какие-то изменения на данной странице, то чтобы они принялись, то необходимо внизу страницы нажать на <code>Save</code></p>
<p>Далее перейдите в таблицу <code>Groups</code> в левой панели, и вы увидите, что уже есть одна группа, она была загружена из фикстур, это группа <code>Авторы</code></p>
<p>Создайте новую группу, название на ваше усмотрение, в моём случае пусть это будет <code>Группа</code>, далее вы можете раздать определенные права пользователям на действия над данными в этой группе.</p>
<p>Допустим можно делать следующие действия со строками в таблицах БД:</p>
<ul>
<li>
<p>добавлять данные (Can add)</p>
</li>
<li>
<p>изменять данные (Can change)</p>
</li>
<li>
<p>удалять данные (Can delete)</p>
</li>
<li>
<p>просматривать данные (Can view)</p>
</li>
</ul>
<p>Возьмите и перенесите права над <code>auth | user</code> из левой колонки в правую, для этого нажмите двойной щелчок левой кнопки мыши на необходимой
строке права или выделите строку и нажмите на символ стрелки вправо.</p>
<p>Сохраните данную группу.</p>
<p><img alt="img_7.png" src="pic/img_7.png" /></p>
<p>Теперь перейдите в таблицу <code>Users</code> и нажмите на пользователя <code>amoskonstantinov</code>, чтобы изменить значения его значений в БД.</p>
<p>Пролистаем вниз до поля <code>Groups</code> и перенесем в правую таблицу вашу созданную группу, если делали как и я, то это будет <code>Группа</code></p>
<p>Чуть ниже есть возможность раздавать права отдельным пользователям (если это необходимо), а не целой группе.</p>
<p>Обязательно сохраняем изменения! Нажимаем на <code>Save</code>.</p>
<p>Теперь проверим, что поменялось после раздачи прав. Разлогинимся, для этого справа вверху есть <code>LOG OUT</code></p>
<p><img alt="img_8.png" src="pic/img_8.png" /></p>
<p>И теперь залогинимся под недавно измененным пользователем </p>
<p><img alt="img_9.png" src="pic/img_9.png" /></p>
<p>Username: <code>amoskonstantinov</code>
Password: <code>Or5G_uRh)V</code></p>
<p>И вы увидите, что этому пользователю доступны только действия над элементами таблицы <code>Users</code> в БД, ровно то, что 
мы и разрешали для группы.</p>
<p>Если зайти под пользователем с staff status, но без единого разрешения, то страница будет достаточно пустой, как на примере
данного пользователя</p>
<p>Username: <code>budimir2021</code>
Password: <code>J2GzZvp!_c</code></p>
<p><img alt="img_10.png" src="pic/img_10.png" /></p>
<p>А если зайти под обычным пользователем, не персоналом, то в админ панель его не пустят, как например</p>
<p>Username: <code>arhip_35</code>
Password: <code>RbT9Zu7rg%</code></p>
<p><img alt="img_11.png" src="pic/img_11.png" /></p>
<p>Пароли и username остальных пользователей (если это необходимо) приведены в <code>users.json</code>, который создадим на 2-ой практике.</p>
<h2 id="22">2.2 Основные таблицы приложения Блог</h2>
<p>В приложении существует 6 таблиц</p>
<p><img alt="img_12.png" src="pic/img_12.png" /></p>
<ul>
<li>
<p><code>Comments</code> - таблица с комментариями  </p>
</li>
<li>
<p><code>Entrys</code>  - таблица с записями статей</p>
</li>
<li>
<p><code>Tags</code>    - таблица с тегами статей</p>
</li>
<li>
<p><code>User profiles</code> - таблица с профилями пользователей   </p>
</li>
<li>
<p><code>Блоги</code>   - таблица с существующими блогами в приложении</p>
</li>
<li>
<p><code>Профили авторов</code>- таблица с профилями авторов</p>
</li>
</ul>
<p>Добавим новую статью на блог-платформу, для этого нажмем на <code>+Add</code> в строке <code>Entry</code></p>
<p>Создайте новую статью. Жирным выделены названия тех параметров, что обязательны для заполнения. Картинку можете загрузить свою, если есть желание
<img alt="img_13.png" src="pic/img_13.png" /></p>
<p><img alt="img_14.png" src="pic/img_14.png" /></p>
<p>После заполнения создайте свою первую запись на платформе через админ панель.</p>
<p>Теперь в БД есть запись созданная через админ панель.</p>
<p><img alt="img_15.png" src="pic/img_15.png" /></p>
<p>Наблюдать за результатом возможно на главной странице приложения. <a href="http://127.0.0.1:8000/" target="_blank">http://127.0.0.1:8000/</a></p>
<p>Пролистайте начальную страницу немного вниз и увидите свой пост.</p>
<p><img alt="img_16.png" src="pic/img_16.png" /></p>
<p>Однако к БД можно подключить не только через админ панель, но и через любой обозреватель БД поддерживающий данную БД.
По умолчанию БД в Django создаётся через SQLite, наша БД не исключение (в будущем рассмотрим извeстную нам PostgreSQL).</p>
<p>К SQLite можно подключиться через SQLiteBrowser <a href="https://sqlitebrowser.org/dl/" target="_blank">https://sqlitebrowser.org/dl/</a> или DBeaver (Community) <a href="https://dbeaver.io/download/" target="_blank">https://dbeaver.io/download/</a>
или другие менеджеры и обозреватели БД.</p>
<p>Рассмотрим <code>Dbeaver</code>.</p>
<p><img alt="img_17.png" src="pic/img_17.png" /></p>
<p><img alt="img_19.png" src="pic/img_19.png" /></p>
<p>Открываем базу данных из проекта</p>
<p><img alt="img_18.png" src="pic/img_18.png" /></p>
<p><img alt="img_20.png" src="pic/img_20.png" /></p>
<p>И если это необходимо используем данные из таблиц</p>
<p><img alt="img_21.png" src="pic/img_21.png" /></p>
<p>Далее разберем как создать свои модели (таблицы в БД) в Django и как можно получать информацию из БД не через админ панель.</p>
<h1 id="3-django">3. Создание моделей в Django</h1>
<p>Модели - это класс в котором описывается наполнение таблицы в БД и определенные связи. 
Модель состоит из названия таблицы и наполнения полей которые там участвуют + дополнительные параметры и возможности.</p>
<p>Стандартно модели прописываются в файле <code>models.py</code> своего приложения. </p>
<p>Откройте файл <code>models.py</code> приложения <code>db_train</code>, которое находится в папке <code>apps</code></p>
<p>Создадим модель <code>Author</code>, для этого необходимо создать одноименный класс <code>Author</code>, который наследуется от <code>models.Model</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-5">class Author(models.Model):
    pass
</code></pre><button class="copy-button" onclick="copyCode('code-block-5')">Копировать код</button></div>

<p>Теперь наполним данную модель(таблицу) описанием полей(колонок) которые она буде хранить.</p>
<p>Для создания поле внутри класса пишут классовый атрибут, причем название этого атрибута соответствует названию поля в 
БД которое мы хотим создать для хранения там данных. В классовый атрибут записывается экземпляр созданный на базе определенного типа данных.</p>
<p>Например:</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-6">class Author(models.Model):
    first_name = models.CharField()
</code></pre><button class="copy-button" onclick="copyCode('code-block-6')">Копировать код</button></div>

<p>Данным кодом было объявлено поле <code>first_name</code>, которое представляет собой строковый тип (CharField). Говорящее о том, что в данном поле
будут храниться данные в строковом типе.</p>
<h2 id="31">3.1 Описание полей</h2>
<p>ORM Django поддерживает множество типов полей рассмотрим часто применяемые:</p>
<ul>
<li>
<p>Поле для хранения целого числа - <code>models.IntegerField()</code>;</p>
</li>
<li>
<p>Поле для хранения вещественного числа - <code>models.FloatField()</code> для чисел типа float, <code>models.DecimalField</code> для чисел с фиксированной точностью 
(допустим финансовых операций с 2-умя значениями после запятой);</p>
</li>
<li>
<p>Поле для хранения булевого значения - <code>models.BooleanField()</code> для хранения <code>True</code> или <code>False</code>;</p>
</li>
<li>
<p>Поле для хранения бинарных данных - <code>models.BinaryField()</code>. Допустим так можно сохранить документ или картинку в базу данных целым файлом;</p>
</li>
<li>
<p>Поле для хранения строки - <code>models.CharField()</code> для небольших предложений или слов размером до 255 символов, можно явно указать максимальный размер строки;</p>
</li>
<li>
<p>Поле для хранения многострочного текста - <code>models.TextField()</code> для больших предложений;</p>
</li>
<li>
<p>Поле для хранения строки email - <code>models.EmailField()</code></p>
</li>
<li>
<p>Поле для хранения текста slug типа - <code>models.SlugField()</code></p>
</li>
<li>
<p>Поле для хранения даты - <code>models.DateField()</code></p>
</li>
<li>
<p>Поле для хранения даты со временем - <code>models.DateTimeField()</code></p>
</li>
<li>
<p>Поле для хранения файла - <code>models.FileField()</code></p>
</li>
<li>
<p>Поле для хранения картинки - <code>models.ImageField()</code></p>
</li>
</ul>
<p>Каждый тип поля в Django соотносит возможности по хранению для конкретной БД. То есть если в БД есть возможность хранить <code>email</code>, 
так как этот тип поддерживается на уровне БД, то будет явная связь с этим типом. 
Если такого типа не поддерживает БД, то Django свяжет его со строковым типом, но сделает определенные
валидации внутри себя перед сохранением, чтобы убедиться, что передаваемое значение в БД соответствует типу <code>email</code>.</p>
<p>Более детально про эти и другие типы можно прочитать в <a href="<a href="https://docs.djangoproject.com/en/5.0/ref/models/fields/#field-types">документации" target="_blank">https://docs.djangoproject.com/en/5.0/ref/models/fields/#field-types">документации</a></a> 
или в файле в <code>fields_and_types.md</code> в разделе <code>1. Описание полей</code></p>
<p>Предположим, что на начальной стадии (не задумываясь о том как будем работать со сложными связями и таблицами) для полноценного описания данных об Авторе
нам достаточно следующих данных(получилось много, но для тренировки самое то):</p>
<table>
<thead>
<tr>
<th>Поле</th>
<th>Имя поля</th>
<th>Тип поля</th>
<th>Класс описания</th>
</tr>
</thead>
<tbody>
<tr>
<td>имя авторского аккаунта</td>
<td>username</td>
<td>slug</td>
<td>models.SlugField</td>
</tr>
<tr>
<td>email</td>
<td>email</td>
<td>email</td>
<td>models.EmailField</td>
</tr>
<tr>
<td>имя</td>
<td>first_name</td>
<td>строковое</td>
<td>models.CharField</td>
</tr>
<tr>
<td>фамилия</td>
<td>last_name</td>
<td>строковое</td>
<td>models.CharField</td>
</tr>
<tr>
<td>отчество</td>
<td>middle_name</td>
<td>строковое</td>
<td>models.CharField</td>
</tr>
<tr>
<td>пол</td>
<td>gender</td>
<td>строковое</td>
<td>models.CharField</td>
</tr>
<tr>
<td>уровень самооценки</td>
<td>self_esteem</td>
<td>decimal</td>
<td>models.DecimalField</td>
</tr>
<tr>
<td>телефон</td>
<td>phone_number</td>
<td>строковое</td>
<td>models.CharField</td>
</tr>
<tr>
<td>город</td>
<td>city</td>
<td>строковое</td>
<td>models.CharField</td>
</tr>
<tr>
<td>биография</td>
<td>bio</td>
<td>текстовое</td>
<td>models.TextField</td>
</tr>
<tr>
<td>возраст</td>
<td>age</td>
<td>целое</td>
<td>models.IntegerField</td>
</tr>
<tr>
<td>дата рождения</td>
<td>date_birth</td>
<td>дата</td>
<td>models.DateField</td>
</tr>
<tr>
<td>согласие с правилами</td>
<td>status_rule</td>
<td>булевое</td>
<td>models.BooleanField</td>
</tr>
<tr>
<td>фото профиля</td>
<td>image</td>
<td>картинка</td>
<td>models.ImageField</td>
</tr>
<tr>
<td>дата и время создания записи в БД</td>
<td>create_at</td>
<td>дата со временем</td>
<td>models.DateTimeField</td>
</tr>
<tr>
<td>дата и время обновления записи в БД</td>
<td>update_at</td>
<td>дата со временем</td>
<td>models.DateTimeField</td>
</tr>
</tbody>
</table>
<p>Колонок много, однако они описывают все часто используемые типы полей.</p>
<p>После того как определились с тем чем будет описываться наша сущность, то необходимо настроить поведение и обработку полей. 
Это делается при помощи параметров передаваемых в класс описания поля при его инициализации.</p>
<p>Параметры можно разбить на 2 группы:
* <code>Общие параметры</code>, которые можно передать в каждый класс описание. <code>Все общие параметры являются необязательными, т.е.
их нужно указывать, если хотите добавить или поменять функционал, что есть по умолчанию</code>.</p>
<ul>
<li><code>Частные параметры</code>, которые разнятся от класса, но в большинстве своём идут в дополнение к общим. 
В зависимости от класса поля есть параметры которые обязательно нужно определить.</li>
</ul>
<p><code>Общие параметры</code> в свою очередь разбиваются на:</p>
<ol>
<li>
<p>Те, что используются для <code>отображения в админ панели</code> или формах:</p>
</li>
<li>
<p><code>verbose_name</code> - Определяет человекочитаемое имя поля. Передаётся если хотите, чтобы поле отображалось в админ панели
как передали, так как умолчанию оно отображается как именовали при названии классовой переменной;</p>
</li>
<li>
<p><code>blank</code> - По умолчанию <code>False</code>. Определяет, может ли поле отображаться как пустое 
(аналог отображения необязательного поля для ввода). Есть передать <code>True</code>, то 
отображение становится менее ярким, название поля становится не жирное;</p>
</li>
<li>
<p><code>editable</code> - По умолчанию <code>True</code>. Определяет, может ли поле отображаться для редактирования. Есть передать <code>False</code>, 
то админ панели данное поле отображаться не будет;</p>
</li>
<li>
<p><code>help_text</code> - По умолчанию <code>None</code>. Отображает вспомогательный текст или инструкции для поля. Текст в админ панели 
отображается маленькими буквами под полем;</p>
</li>
<li>
<p><code>error_messages</code> - Позволяет определить пользовательские сообщения об ошибках для поля. 
Вы можете переопределить предопределенные сообщения об ошибках, такие как null, blank, invalid, и другие.</p>
</li>
<li>
<p><code>choices</code> - Позволяет ограничить список допустимых значений, которые могут быть присвоены определенному полю. 
Используется для создания поля с предопределенным набором вариантов выбора (выпадающий список). 
Параметр <code>choices</code> принимает список кортежей, где каждый кортеж содержит два элемента: значение и человекочитаемое 
(которое будет отображаться в админ панели или форме) представление значения.</p>
</li>
<li>
<p>Те, что используются для <code>настройки действий с БД</code>:</p>
</li>
<li>
<p><code>null</code> - По умолчанию <code>False</code>. Определяет, может ли поле в БД хранить значение NULL.</p>
</li>
<li>
<p><code>unique</code> - По умолчанию <code>False</code>. Определяет, должно ли поле содержать уникальные значения.</p>
</li>
<li>
<p><code>default</code> - Устанавливает значение по умолчанию для поля. Если создавать объект базы данных и не передать
значение полю, то в него запишется значение по умолчанию). Значение может быть указано в виде конкретного значения 
или в виде вызова функции. Если не задать параметр <code>null</code> или <code>default</code>, то механизм Django будет требовать обязательно заполнить поле.</p>
</li>
<li>
<p><code>primary_key</code> - По умолчанию <code>False</code>. Указывает, является ли поле первичным ключом модели. 
По умолчанию, первичным ключом является id в вашей таблице, но вы можете использовать этот параметр со значением <code>True</code>, 
чтобы явно указать поле в качестве первичного ключа. <code>Во всей таблице только одно поле может быть с параметром primary_key=True</code>.</p>
</li>
<li>
<p><code>validators</code> - Позволяет задать список пользовательских валидаторов. По умолчанию вызывает встроенные валидаторы для своего поля, 
но передав сюда список валидаторов вызывает их после встроенных валидаторов. 
Валидаторы используются для проверки вводимых данных и обеспечения их соответствия определенным условиям <code>до передачи данных на сохранение в БД</code>.</p>
</li>
<li>
<p><code>db_column</code> - Указывает название столбца в базе данных, к которому привязано поле. 
Если параметр не указан, Django будет использовать имя поля в качестве названия столбца.</p>
</li>
<li>
<p><code>db_index</code> - По умолчанию <code>False</code>. Определяет, должен ли быть создан индекс для данного поля в базе данных.</p>
</li>
<li>
<p><code>db_tablespace</code> - Указывает название табличного пространства базы данных, в котором должно храниться поле. 
Если параметр не указан, Django будет использовать значение по умолчанию (смесь названия приложения и названия модели) 
для базы данных.</p>
</li>
</ol>
<p><code>Частные параметры</code> в свою очередь зависят от поля, рассмотрим примеры:</p>
<ul>
<li>
<p>поля <code>models.CharField</code>, <code>models.BinaryField</code> обладают <code>обязательным</code> параметром <code>max_length</code>. Максимальная длина (в символах) поля. 
<code>max_length</code> применяется на уровне базы данных и при проверке Django использует встроенный валидатор на проверку 
максимальной длины <code>MaxLengthValidator</code></p>
</li>
<li>
<p>поля <code>models.EmailField</code>, <code>models.URLField</code>, <code>models.SlugField</code> тоже обладают параметром <code>max_length</code>, только в данном
случае по умолчанию уже они определены и их можно не задавать, если устраивает ограничение.</p>
</li>
<li>
<p>поле <code>models.DecimalField</code> обладает <code>обязательными</code> параметрами:</p>
<ul>
<li><code>max_digits</code> - Максимально допустимое количество цифр в числе; </li>
<li><code>decimal_places</code> - Количество десятичных разрядов для хранения с числом. </li>
</ul>
</li>
</ul>
<p>Пример для максимально поддерживаемого числа 999.99 (значение 1000.0 и выше уже не будет поддерживаться)
<code>models.DecimalField(max_digits=5, decimal_places=2)</code></p>
<ul>
<li>
<p>поля <code>models.DateField</code>, <code>models.DateTimeField</code> обладают <code>необязательными</code> параметрами <code>auto_now</code> и <code>auto_now_add</code>. 
Одновременно можно задать только один из этих параметров. </p>
<ul>
<li><code>auto_now</code> - По умолчанию <code>False</code>. Если <code>True</code>, то автоматически устанавливает текущее временное значение каждый раз, когда объект <code>сохраняется</code>. 
Полезно для отметок времени последнего изменения строки в БД.</li>
<li><code>auto_now_add</code> - По умолчанию <code>False</code>. Если <code>True</code>, то автоматически устанавливает поле на текущее временное значение, когда объект <code>создается впервые</code>. 
Полезно для отметок времени создания строки в БД.</li>
</ul>
</li>
<li>
<p>поля <code>models.FileField</code>, <code>models.ImageField</code> обладают <code>необязательным</code> параметром <code>upload_to</code>. Этот атрибут обеспечивает способ указания каталога загрузки и имени файла 
и может быть установлен двумя способами (строкой и функцией, которая выполнится при сохранении)</p>
</li>
</ul>
<p>Подробнее про передаваемые параметры можно прочитать в <a href="<a href="https://docs.djangoproject.com/en/5.0/ref/models/fields/#field-options">документации" target="_blank">https://docs.djangoproject.com/en/5.0/ref/models/fields/#field-options">документации</a></a> 
или файле <code>fields_and_types.md</code> в разделе <code>2. Общие параметры поля</code> и описание частных параметров в <code>1. Описание полей</code>.</p>
<h2 id="32">3.2 Применение параметров</h2>
<p>Далее определим какие ограничения мы хотим использовать на наши поля:</p>
<p>Имя, Фамилия, Отчество, Город ограничим длиной в 100 символов;</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-7">models.CharField(max_length=100)
</code></pre><button class="copy-button" onclick="copyCode('code-block-7')">Копировать код</button></div>

<p>Пол ограничим стандартными фразами <code>мужской</code>, <code>женский</code>, для этого воспользуемся параметром <code>choices</code> (при выборе 
в админ панели <code>мужской</code> в БД запишется <code>м</code>, при выборе <code>женский</code> в БД запишется <code>ж</code>), с ограничением длины в 1 символ.</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-8">gender = models.CharField(max_length=1, choices=[('м', 'мужской'), ('ж', 'женский')])
</code></pre><button class="copy-button" onclick="copyCode('code-block-8')">Копировать код</button></div>

<p>Телефон ограничим длиной в 12 символ, по стандарту +79991234567</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-9">phone_number = models.CharField(max_length=12)
</code></pre><button class="copy-button" onclick="copyCode('code-block-9')">Копировать код</button></div>

<p>Уровень самооценки ограничим одним знаком до разделителя от 0 до 5 и одним знаком после разделителя.</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-10">self_esteem = models.DecimalField(max_digits=2, decimal_places=1)
</code></pre><button class="copy-button" onclick="copyCode('code-block-10')">Копировать код</button></div>

<p>Так как у нас есть дата рождения и возраст и возраст вытекает из даты рождения, то скроем возможность задания возраста 
и будем его вычислять перед сохранением в БД (это реализуем чуть позже), сейчас только скроем поле и 
сделаем возможность устанавливать его как NULL в БД.  </p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-11">age = models.IntegerField(null=True, editable=False)
date_birth = models.DateField()
</code></pre><button class="copy-button" onclick="copyCode('code-block-11')">Копировать код</button></div>

<p>Фото профиля хотим, чтобы загружалось в папку <code>foto_profile</code> на нашем сервере для это прописываем это в <code>upload_to</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-12">image = models.ImageField(upload_to='foto_profile')
</code></pre><button class="copy-button" onclick="copyCode('code-block-12')">Копировать код</button></div>

<p>Для работой с датой и временем создания и обновления записи в БД используем <code>auto_now=True</code> и <code>auto_now_add=True</code>. В админ панели не будет отображаться, 
будет заполняться автоматически при сохранении в БД. </p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-13">create_at = models.DateTimeField(auto_now_add=True)
update_at = models.DateTimeField(auto_now=True)
</code></pre><button class="copy-button" onclick="copyCode('code-block-13')">Копировать код</button></div>

<p>В итоге теперь наша модель будет выглядеть так:</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-14">class Author(models.Model):
    username = models.SlugField()
    email = models.EmailField()
    first_name = models.CharField(max_length=100)
    last_name = models.CharField(max_length=100)
    middle_name = models.CharField(max_length=100)
    gender = models.CharField(max_length=1, choices=[('м', 'мужской'), ('ж', 'женский')])
    self_esteem = models.DecimalField(max_digits=2, decimal_places=1)
    phone_number = models.CharField(max_length=12)
    city = models.CharField(max_length=100)
    bio = models.TextField()
    age = models.IntegerField(null=True, editable=False)
    date_birth = models.DateField()
    status_rule = models.BooleanField()
    image = models.ImageField(upload_to='foto_profile')
    create_at = models.DateTimeField(auto_now_add=True)
    update_at = models.DateTimeField(auto_now=True)
</code></pre><button class="copy-button" onclick="copyCode('code-block-14')">Копировать код</button></div>

<h2 id="33">3.3 Создание таблицы в БД</h2>
<p>После того как определись с наполнением таблицы, то самое время её создать в БД. Для этого выполняем команду</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-15">python manage.py makemigrations
</code></pre><button class="copy-button" onclick="copyCode('code-block-15')">Копировать код</button></div>

<p>Чтобы создать питоновскую связь с таблицей в БД.</p>
<p>Вы можете увидеть следующее, говорящее о том, что связь создана. Посмотреть как выглядит эта связь можно в соответствующей папке</p>
<p><code>apps/db_tain/migrations/0001_initial.py</code></p>
<p><img alt="img_22.png" src="pic/img_22.png" /></p>
<p>Затем переносим схему таблицы в БД, для этого прописываем</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-16">python manage.py migrate
</code></pre><button class="copy-button" onclick="copyCode('code-block-16')">Копировать код</button></div>

<p><img alt="img_23.png" src="pic/img_23.png" /></p>
<p>Теперь самое время зайти в админ панель и посмотреть на наше творение!</p>
<p>Но вот незадача, админ панель не показывает нашу таблицу</p>
<p><img alt="img_24.png" src="pic/img_24.png" /></p>
<p>Чтобы произошло отображение таблицы, то необходимо её зарегистрировать. Для этого существует специальный файл <code>admin.py</code> 
для отображения и настройки админ панели для данного приложения.</p>
<p>Зайдите в приложение <code>db_train</code>, затем в файл <code>admin.py</code></p>
<p>И пропишите следующее(подгружаем таблицу из моделей и регистрируем её для отображения в админ панели):</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-17">from django.contrib import admin
from .models import Author

admin.site.register(Author)
</code></pre><button class="copy-button" onclick="copyCode('code-block-17')">Копировать код</button></div>

<p>Теперь таблица на месте</p>
<p><img alt="img_25.png" src="pic/img_25.png" /></p>
<p>Создайте одного автора, через административную панель. </p>
<p>К сожалению по умолчанию поле ввода даты не обладает быстрой прокруткой по годам,
поэтому будет проще вбить данные в формате <code>yyyy-mm-dd</code></p>
<p><img alt="img_26.png" src="pic/img_26.png" /></p>
<p>Если какое-то поле будет не заполнено, то вылезет предупреждение</p>
<p><img alt="img_27.png" src="pic/img_27.png" /></p>
<p>Как только Django создаст строку в БД, то данный автор появится в панели, но вот, что это за автор непонятно</p>
<p><img alt="img_28.png" src="pic/img_28.png" /></p>
<p>Чтобы сделать эту строку удобочитаемой, необходимо переопределить метод <code>__str__</code> в котором вернуть как будет отображаться данная строка.</p>
<p>Переопределите метод в вашем классе <code>Author</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-18">def __str__(self):
    initials = None  # Инициалы
    if self.first_name and self.middle_name:
        initials = f&quot;{self.first_name.upper()[0]}.{self.middle_name.upper()[0]}.&quot;
    return f&quot;{self.username} - {self.last_name} {initials}&quot;
</code></pre><button class="copy-button" onclick="copyCode('code-block-18')">Копировать код</button></div>

<p>Теперь автор более читаемый и понятно кто это</p>
<p><img alt="img_29.png" src="pic/img_29.png" /></p>
<h2 id="34">3.4 Изменение структуры таблицы в БД</h2>
<p>Теперь давайте сделаем модель более удобной для нашей работы. В нашем случае необходимо добавить проверку того, что телефонный номер переданный
в поле соответствует стандартам. Это этого добавим валидацию для этого поля. </p>
<p>Также изменим отображение названия полей, чтобы было понятно на русском, что это за поле, 
добавим подсказки, и упростим себе задачу по созданию пользователя добавив большинству поле возможность делать их сохранить пустыми в БД. </p>
<p><img alt="img_30.png" src="pic/img_30.png" /></p>
<p>Но перед этим посмотрим куда загрузилась наша картинка? Ранее мы писали папку <code>foto_profile</code>, но такой папки нет в корне, а она есть
в папке <code>media</code>. Там и лежит ваша картинка.</p>
<p>За то, что корнем для загрузки медиа файлов является папка <code>media/</code> отвечает <code>MEDIA_ROOT</code> в <code>settings.py</code>. При создании проекта
<code>MEDIA_ROOT</code> не прописывается автоматические. Если планируется работать с загрузкой файлов на сервер, то этот параметр прописывают.</p>
<p><img alt="img_31.png" src="pic/img_31.png" /></p>
<p>Далее вернемся в <code>apps/db_train</code> в <code>models.py</code></p>
<p>По умолчанию в Django нет полей для мобильного телефона, которые будут это валидировать. Чтобы произвести валидацию, 
то необходимо её написать.</p>
<p>Можно использовать функцию для валидации, а можно специальный класс из блока валидаций Django <code>from django.core.validators import RegexValidator</code>.</p>
<p>В данном случае будем использовать валидацию с использованием регулярного выражения. Саму переменную которая будет вызываться можно прописать, вне класса Таблицы <code>Author</code>. 
А можно как классовый атрибут, это не будет считаться полем, так как мы не создаём экземпляр от типа поля, а экземпляр от валидации. </p>
<p>Данный валидатор передаём в параметр <code>validators</code> в поле <code>phone_number</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-19">from django.core.validators import RegexValidator

class Author(models.Model):
    phone_regex = RegexValidator(
            regex=r'^\+79\d{9}$',
            message=&quot;Телефонный номер должен быть формата: '+79123456789'.&quot;
        )
    # ...
    phone_number = models.CharField(max_length=12, validators=[phone_regex])
    # ...
</code></pre><button class="copy-button" onclick="copyCode('code-block-19')">Копировать код</button></div>

<p><img alt="img_32.png" src="pic/img_32.png" /></p>
<p>Для уровня самооценки нам тоже нужно поставить ограничения, не меньше 0, не больше 5. Для этого воспользуемся валидаторами
<code>MinValueValidator</code>, <code>MaxValueValidator</code> из <code>from django.core.validators import MinValueValidator, MaxValueValidator</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-20">from django.core.validators import MinValueValidator, MaxValueValidator

class Author(models.Model):
    # ...
    self_esteem = models.DecimalField(max_digits=2,
                                          decimal_places=1,
                                          validators=[MinValueValidator(0, &quot;Диапазон [0.0, 5.0]&quot;),
                                                      MaxValueValidator(5, &quot;Диапазон [0.0, 5.0]&quot;)])
    # ...
</code></pre><button class="copy-button" onclick="copyCode('code-block-20')">Копировать код</button></div>

<p>Далее изменим отображение названия полей, чтобы было понятно на русском, что это за поле. 
Для этого в каждом поле передадим параметр <code>verbose_name</code> и пропишем как будет называться поле.</p>
<p>Чтобы добавить подсказки, передадим параметр <code>help_text</code>, где пишется сообщение.</p>
<p>И напоследок упростим себе задачу и сделаем всего несколько полей обязательными, остальными сделаем такими, чтобы 
их можно было оставить пустыми, а в БД запишется или NULL или значение по умолчанию.</p>
<p>В итоге класс теперь выглядит следующим образом:</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-21">class Author(models.Model):
    phone_regex = RegexValidator(
        regex=r'^\+79\d{9}$',
        message=&quot;Телефонный номер должен быть формата: '+79123456789'.&quot;
    )

    username = models.SlugField(verbose_name='Имя аккаунта',
                                help_text=&quot;Введите username, не длиннее 50 символов. Использовать нужно английский алфавит, разделять фразы нужно символом '-'&quot;)

    email = models.EmailField(verbose_name='Адрес электронной почты',
                              help_text=&quot;Адрес почты в формате *@*.*&quot;)

    first_name = models.CharField(max_length=100,
                                  verbose_name='Имя',
                                  help_text=&quot;Ограничение - не более 100 символов&quot;,
                                  null=True,
                                  blank=True,
                                  )

    last_name = models.CharField(max_length=100,
                                 verbose_name='Фамилия',
                                 help_text=&quot;Ограничение - не более 100 символов&quot;,
                                 null=True,
                                 blank=True,
                                 )

    middle_name = models.CharField(max_length=100,
                                   verbose_name='Отчество',
                                   help_text=&quot;Ограничение - не более 100 символов&quot;,
                                   null=True,
                                   blank=True,
                                   )

    gender = models.CharField(max_length=1,
                              choices=[('м', 'мужской'), ('ж', 'женский')],
                              verbose_name='Пол',
                              help_text=&quot;Выберите пол&quot;,
                              null=True,
                              blank=True,
                              )

    self_esteem = models.DecimalField(max_digits=2,
                                      decimal_places=1,
                                      validators=[MinValueValidator(0, &quot;Диапазон [0.0, 5.0]&quot;),
                                                  MaxValueValidator(5, &quot;Диапазон [0.0, 5.0]&quot;)],
                                      verbose_name='Уровень самооценки',
                                      help_text=&quot;Введите уровень вашей самооценки, только честно! Градация от 0 до 5, где 0 - 'я молодец', 5 - 'я умница'&quot;,
                                      null=True,
                                      blank=True,
                                      )

    phone_number = models.CharField(max_length=12,
                                    validators=[phone_regex],
                                    verbose_name='Номер телефона',
                                    help_text=&quot;Введите номер телефона через '+7' без пробелов в формате +79123456789 &quot;,
                                    null=True,
                                    blank=True,
                                    )

    city = models.CharField(max_length=100,
                            verbose_name='Город',
                            help_text=&quot;Введите название города&quot;,
                            null=True,
                            blank=True,
                            )

    bio = models.TextField(verbose_name='Биография',
                           help_text=&quot;Напишите здесь о том, почему Вы так хороши&quot;,
                           null=True,
                           blank=True,
                           )

    age = models.IntegerField(null=True, editable=False)

    date_birth = models.DateField(verbose_name='Дата рождения',
                                  help_text=&quot;Посланцев из будущего не регистрируем!&quot;,
                                  null=True,
                                  blank=True,
                                  )

    status_rule = models.BooleanField(verbose_name='Согласие с правилами',
                                      help_text=&quot;А ты их читал или как обычно просто галочку поставил?&quot;,
                                      )

    image = models.ImageField(upload_to='foto_profile',
                              verbose_name='Картинка профиля',
                              help_text=&quot;Фото в профиль, можно не своё! Ну или хоть какое-то. Ладно можно без фото&quot;,
                              null=True,
                              blank=True,
                              )

    create_at = models.DateTimeField(auto_now_add=True)
    update_at = models.DateTimeField(auto_now=True)

    def __str__(self):
        initials = None  # Инициалы
        if self.first_name and self.middle_name:
            initials = f&quot;{self.first_name.upper()[0]}.{self.middle_name.upper()[0]}.&quot;
        return f&quot;{self.username} - {self.last_name} {initials}&quot;
</code></pre><button class="copy-button" onclick="copyCode('code-block-21')">Копировать код</button></div>

<p>А в панели администратора это выглядит следующим образом</p>
<p><img alt="img_33.png" src="pic/img_33.png" />
<img alt="img_34.png" src="pic/img_34.png" /></p>
<p>Сделаем ещё одну функциональность, это добавим ограничение на уникальные поля, хочется чтобы <code>имя аккаунта</code>, <code>адрес почты</code> и <code>телефон</code> были уникальные. 
Для этого у данных полей выставляем параметр <code>unique=True</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-22">username = models.SlugField(# ...
                            unique=True,
                            )

email = models.EmailField(# ...
                          unique=True,
                          )

phone_number = models.CharField(# ...
                                unique=True,
                                )
</code></pre><button class="copy-button" onclick="copyCode('code-block-22')">Копировать код</button></div>

<p>И последняя модификация, это изменение отображения названия таблицы Author. Это делает при помощи метакласса Meta внутри класса.</p>
<p>Чтобы поменять название таблицы для отображения в единственном числе, то переопределяется классовый атрибут <code>verbose_name</code>, 
а во множественном - <code>verbose_name_plural</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-23">class Author(models.Model):
    # ...
    class Meta:
        verbose_name = &quot;Автор&quot;
        verbose_name_plural = &quot;Авторы&quot;
</code></pre><button class="copy-button" onclick="copyCode('code-block-23')">Копировать код</button></div>

<p><img alt="img_35.png" src="pic/img_35.png" /></p>
<p>Теперь осталось обновить миграции, для этого вызываем </p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-24">python manage.py makemigrations
</code></pre><button class="copy-button" onclick="copyCode('code-block-24')">Копировать код</button></div>

<p>Новые изменения добавились в миграции</p>
<p><img alt="img_36.png" src="pic/img_36.png" /></p>
<p>А теперь переносим эти изменения в БД</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-25">python manage.py migrate
</code></pre><button class="copy-button" onclick="copyCode('code-block-25')">Копировать код</button></div>

<p>Таким образом мы внесли изменения в структуру БД.</p>
<p><img alt="img_37.png" src="pic/img_37.png" /></p>
<p>И отображение таблицы стало таким, какое прописывали</p>
<p><img alt="img_39.png" src="pic/img_39.png" /></p>
<p>На текущий момент вроде бы всё, но упущен один интересный момент, а именно день рождения есть, а сколько лет мы не передаём, 
хотя такое поле есть в таблице. В таких случаях вычисление происходит непосредственно перед сохранением в БД. Для это
перегружают метод <code>save</code> в классе, где приписывают какие действия необходимо совершить при сохранении в БД.</p>
<p>Добавьте данный код в класс <code>Author</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-26">from datetime import datetime

class Author(models.Model):
    # ...    
    def save(self, *args, **kwargs):
        if self.date_birth:  # Если известен день рождения
            today = datetime.today()  # Определяем текущие параметры даты
            # Определяем добавку, был ли уже день рождения в этом году? Если не был, то 1, если был, то 0
            additional_year = (today.month, today.day) &lt; (self.date_birth.month, self.date_birth.day)
            self.age = today.year - self.date_birth.year - additional_year  # Перезаписываем значение
        super().save(*args, **kwargs)
</code></pre><button class="copy-button" onclick="copyCode('code-block-26')">Копировать код</button></div>

<p>Попробуйте теперь сделать обновление миграций и перенос этих данных в БД.</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-27">python manage.py makemigrations
</code></pre><button class="copy-button" onclick="copyCode('code-block-27')">Копировать код</button></div>

<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-28">python manage.py migrate
</code></pre><button class="copy-button" onclick="copyCode('code-block-28')">Копировать код</button></div>

<p>Вы увидите, что изменений нет, так как написание дополнительных методов или перегрузка методов не меняет структуру таблицы,
это просто дополнительный функционал.</p>
<p><img alt="img_38.png" src="pic/img_38.png" /></p>
<h2 id="35">3.5 Заполнение данных в БД</h2>
<p>Загрузим данные по авторам из ещё одной фикстуры. Фикстура <code>data_author.json</code> лежит в папке <code>files/lab1</code></p>
<p>Выполните команду, чтобы загрузить данные из этого файла</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-29">python manage.py loaddata files/lab1/data_author.json 
</code></pre><button class="copy-button" onclick="copyCode('code-block-29')">Копировать код</button></div>

<p>Теперь в вашей БД 11 авторов. Добавим ещё одного вручную через консоль <code>shell</code>.</p>
<p>Чтобы открыть консоль, введите команду</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-30">python manage.py shell
</code></pre><button class="copy-button" onclick="copyCode('code-block-30')">Копировать код</button></div>

<p>Появится интерактивная консоль, где можно выполнять команды и тем самым добавить данные в БД. Но перед этим необходимо 
подгрузить таблицу <code>Author</code>. В интерактивной консоли выполните</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-31">from apps.db_train.models import Author
</code></pre><button class="copy-button" onclick="copyCode('code-block-31')">Копировать код</button></div>

<p>Весь код приведенный ниже выполняется в интерактивной оболочке </p>
<p>Создадим авторов 2-умя способами с использованием <code>save</code> и через <code>create</code></p>
<p>Для записи данных с использованием save необходимо создать экземпляр, а затем его сохранить. Главное, что значения 
передаются в любой класс таблицы только как <code>именованные переменные</code>.</p>
<p>В интерактивной консоли выполните</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-32">obj = Author(username='my_author', email='author@author.ru', gender='м', status_rule=True) 
obj.save() 
</code></pre><button class="copy-button" onclick="copyCode('code-block-32')">Копировать код</button></div>

<p><img alt="img_40.png" src="pic/img_40.png" /></p>
<p>Затем создаём автора через <code>create</code>. Для это используется <code>Author.objects.create</code></p>
<p>Чтобы передать дату, необходимо использовать объект <code>datetime</code></p>
<p>Выполните в интерактивной консоли следующий код</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-33">from datetime import date
Author.objects.create(username='my_author1', email='author1@author.ru', gender='ж', status_rule=False, date_birth=date(1990, 12,12))
</code></pre><button class="copy-button" onclick="copyCode('code-block-33')">Копировать код</button></div>

<p><img alt="img_41.png" src="pic/img_41.png" /></p>
<p>Теперь были созданы 2 автора разными способами.</p>
<h2 id="36">3.6 Получение, изменение, удаление данных из БД</h2>
<h3 id="361">3.6.1 Получение</h3>
<p>Чтобы получить все элементы, используют конструкцию <code>objects.all()</code> в своей таблице.</p>
<p>В нашем случае это</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-34">Author.objects.all()
</code></pre><button class="copy-button" onclick="copyCode('code-block-34')">Копировать код</button></div>

<p><img alt="img_42.png" src="pic/img_42.png" /></p>
<p>Чтобы получить одну строку в БД, то применяется конструкция <code>objects.get(поле=значение)</code> в своей таблице. Где поле - название поля по которому ищем,
значение - искомое значение у поля. Если объект не найден, то вызовется ошибка.</p>
<p>Как пример необходимо получить строку, где у автора имя <code>Админ</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-35">Author.objects.get(first_name='Админ')
</code></pre><button class="copy-button" onclick="copyCode('code-block-35')">Копировать код</button></div>

<p><img alt="img_43.png" src="pic/img_43.png" /></p>
<p>Чтобы получить несколько значений применяют фильтрацию с использованием конструкции <code>objects.filter(поле=значение)</code>.</p>
<p>Как пример необходимо получить строки, где пол автора женский, а другим запросом, где мужской</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-36">Author.objects.filter(gender='ж')
Author.objects.filter(gender='м')
</code></pre><button class="copy-button" onclick="copyCode('code-block-36')">Копировать код</button></div>

<p><img alt="img_44.png" src="pic/img_44.png" /></p>
<h3 id="362">3.6.2 Обновление</h3>
<p>Чтобы обновить данные, необходимо сначала получить объект из БД, затем обновить его атрибуты и снова его сохранить через <code>save</code>.</p>
<p>Пример: получим автора с id=2 и изменим ему название города</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-37">author = Author.objects.get(id=2)
&gt;&gt;&gt; author.city = 'Санкт-Петербург'
&gt;&gt;&gt; author.save() 
</code></pre><button class="copy-button" onclick="copyCode('code-block-37')">Копировать код</button></div>

<p>Если есть необходимость, то возможно изменить данные во множестве запросов (queryset), при помощи <code>update</code> таким образов в
каждый объект, что есть в queryset в указанное поле(поля) запишутся значения.</p>
<p>Пример: Заменить статус ознакомления <code>status_rule</code> на <code>True</code> тех авторов, чей город <code>Москва</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-38">Author.objects.filter(city='Москва').update(status_rule=True)
</code></pre><button class="copy-button" onclick="copyCode('code-block-38')">Копировать код</button></div>

<p><img alt="img_45.png" src="pic/img_45.png" /></p>
<h3 id="363">3.6.3 Удаление</h3>
<p>Чтобы удалить данные, необходимо сначала получить объект из БД, затем удалить его через метод <code>delete()</code>.</p>
<p>Пример: Удалить автора с email <code>author1@author.ru</code></p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-39">author = Author.objects.get(email='author1@author.ru')
author.delete()
</code></pre><button class="copy-button" onclick="copyCode('code-block-39')">Копировать код</button></div>

<p><img alt="img_46.png" src="pic/img_46.png" /></p>
<p>Если требуется удалить несколько элементов и есть множество запросов (queryset), то можно их удалить через это queryset.</p>
<p>Пример: требуется удалить всех авторов, кто не указал город</p>
<div class="code-container"><pre class="highlight"><code class="language-python linenums" id="code-block-40">Author.objects.filter(city=None).delete()
Author.objects.count()  # 7 - Количество оставшихся записей
</code></pre><button class="copy-button" onclick="copyCode('code-block-40')">Копировать код</button></div>

<p><img alt="img_47.png" src="pic/img_47.png" /></p>
<h1 id="_1">Практика закончена</h1>
<hr />
<!-- ## **<u>Необязательный блок</u> (выполнение по желанию)** -->

<!-- ## 4. Настройка отображения в админ панели -->

</div>
        </body>
        </html>
    